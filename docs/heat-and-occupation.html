<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Diego Flores" />


<title>Heat and Occupation in heatlabor project directory</title>

<script src="site_libs/header-attrs-2.28/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="heat_and_occupation.html">Heat and Occupation</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="resources.html">Resources</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Heat and Occupation in heatlabor project
directory</h1>
<h4 class="author">Diego Flores</h4>
<h4 class="date">8/16/2024</h4>

</div>


<p>Consider using a leaflet map, connects to google API, zooming sp -
more traditional gis work</p>
<pre class="r"><code># install_github(&quot;mikeasilva/blsAPI&quot;) #success </code></pre>
<pre class="r"><code># qcewGetIndustryData &lt;- function (year, qtr, industry)
  
qcewGetIndustryData &lt;- function (year, qtr, industry) {
    url &lt;- &quot;http://data.bls.gov/cew/data/api/YEAR/QTR/industry/INDUSTRY.csv&quot;
    url &lt;- sub(&quot;YEAR&quot;, year, url, ignore.case=FALSE)
    url &lt;- sub(&quot;QTR&quot;, tolower(qtr), url, ignore.case=FALSE)
    url &lt;- sub(&quot;INDUSTRY&quot;, industry, url, ignore.case=FALSE)
    read.csv(url, header = TRUE, sep = &quot;,&quot;, quote=&quot;\&quot;&quot;, dec=&quot;.&quot;, na.strings=&quot; &quot;, skip=0)
}</code></pre>
<pre class="r"><code>ffood &lt;- qcewGetIndustryData(&quot;2023&quot;, &quot;a&quot;, &quot;722513&quot;)
str(ffood)</code></pre>
<pre><code>## &#39;data.frame&#39;:    3633 obs. of  38 variables:
##  $ area_fips                       : chr  &quot;01000&quot; &quot;01000&quot; &quot;01001&quot; &quot;01003&quot; ...
##  $ own_code                        : int  2 5 5 5 5 5 5 5 5 5 ...
##  $ industry_code                   : int  722513 722513 722513 722513 722513 722513 722513 722513 722513 722513 ...
##  $ agglvl_code                     : int  58 58 78 78 78 78 78 78 78 78 ...
##  $ size_code                       : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ year                            : int  2023 2023 2023 2023 2023 2023 2023 2023 2023 2023 ...
##  $ qtr                             : chr  &quot;A&quot; &quot;A&quot; &quot;A&quot; &quot;A&quot; ...
##  $ disclosure_code                 : chr  &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; ...
##  $ annual_avg_estabs               : int  1 4688 36 218 28 9 30 3 20 114 ...
##  $ annual_avg_emplvl               : int  0 82373 857 3348 513 163 537 70 363 2352 ...
##  $ total_annual_wages              : num  0.00 1.62e+09 1.68e+07 7.26e+07 8.42e+06 ...
##  $ taxable_annual_wages            : num  0.00 8.06e+08 8.46e+06 3.55e+07 5.00e+06 ...
##  $ annual_contributions            : int  0 4017812 29196 199965 40013 6079 15380 2806 12208 83347 ...
##  $ annual_avg_wkly_wage            : int  0 379 377 417 316 288 338 228 314 362 ...
##  $ avg_annual_pay                  : int  0 19700 19598 21683 16424 14976 17589 11875 16351 18810 ...
##  $ lq_disclosure_code              : chr  &quot;N&quot; &quot;&quot; &quot;&quot; &quot;&quot; ...
##  $ lq_annual_avg_estabs            : num  37.92 1.35 1.51 1.18 2.13 ...
##  $ lq_annual_avg_emplvl            : num  0 1.32 2.4 1.34 2.21 1.13 2.02 0.85 1.74 1.79 ...
##  $ lq_total_annual_wages           : num  0 1.39 3.03 1.92 2.67 1.05 2.6 0.67 2.09 2.17 ...
##  $ lq_taxable_annual_wages         : num  0 1.64 3.37 1.71 2.77 1.29 2.65 0.87 1.89 2.48 ...
##  $ lq_annual_contributions         : num  0 1.71 2.17 2.1 4.6 1.09 2.11 0.54 1.12 1.94 ...
##  $ lq_annual_avg_wkly_wage         : num  0 1.06 1.26 1.42 1.21 0.94 1.29 0.79 1.2 1.21 ...
##  $ lq_avg_annual_pay               : num  0 1.06 1.26 1.42 1.21 0.94 1.29 0.79 1.2 1.21 ...
##  $ oty_disclosure_code             : chr  &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; ...
##  $ oty_annual_avg_estabs_chg       : int  0 120 -1 12 4 0 0 -1 -2 -2 ...
##  $ oty_annual_avg_estabs_pct_chg   : num  0 2.6 -2.7 5.8 16.7 0 0 -25 -9.1 -1.7 ...
##  $ oty_annual_avg_emplvl_chg       : int  0 3495 38 209 92 21 22 4 -10 7 ...
##  $ oty_annual_avg_emplvl_pct_chg   : num  0 4.4 4.6 6.7 21.9 14.8 4.3 6.1 -2.7 0.3 ...
##  $ oty_total_annual_wages_chg      : num  0.00 1.30e+08 1.79e+06 4.96e+06 1.55e+06 ...
##  $ oty_total_annual_wages_pct_chg  : num  0 8.7 11.9 7.3 22.6 17.7 10.2 6.4 3.7 5 ...
##  $ oty_taxable_annual_wages_chg    : num  0 41123637 423393 2409947 1123385 ...
##  $ oty_taxable_annual_wages_pct_chg: num  0 5.4 5.3 7.3 29 8.9 4.9 5.5 1.5 1.7 ...
##  $ oty_annual_contributions_chg    : int  0 -3722932 -40765 -154937 -8544 -5704 -22076 -3674 -20713 -130407 ...
##  $ oty_annual_contributions_pct_chg: num  0 -48.1 -58.3 -43.7 -17.6 -48.4 -58.9 -56.7 -62.9 -61 ...
##  $ oty_annual_avg_wkly_wage_chg    : int  0 15 25 3 2 7 18 0 19 16 ...
##  $ oty_annual_avg_wkly_wage_pct_chg: num  0 4.1 7.1 0.7 0.6 2.5 5.6 0 6.4 4.6 ...
##  $ oty_avg_annual_pay_chg          : int  0 773 1280 136 118 369 949 40 990 843 ...
##  $ oty_avg_annual_pay_pct_chg      : num  0 4.1 7 0.6 0.7 2.5 5.7 0.3 6.4 4.7 ...</code></pre>
<pre class="r"><code>lac_ff &lt;- ffood %&gt;% 
  rename(fips = area_fips) %&gt;% 
  filter(fips == &quot;06037&quot;)
  
carwash &lt;- qcewGetIndustryData(&quot;2023&quot;, &quot;a&quot;, &quot;811192&quot;)
lac_carwash &lt;- carwash %&gt;% 
  rename(fips = area_fips) %&gt;% 
  filter(fips == &quot;811192&quot;)</code></pre>
<p>Area notes: 06037 Los Angeles County, California 06059 Orange County,
California 06071 San Bernardino County, California Operating warehousing
and storage facilities and providing related logistics services–are
classified in Industry Group 4931, Warehousing and Storage.</p>
<pre class="r"><code>qcewGetAreaData &lt;- function(year, qtr, area) {
    url &lt;- &quot;http://data.bls.gov/cew/data/api/YEAR/QTR/area/AREA.csv&quot;
    url &lt;- sub(&quot;YEAR&quot;, year, url, ignore.case=FALSE)
    url &lt;- sub(&quot;QTR&quot;, tolower(qtr), url, ignore.case=FALSE)
    url &lt;- sub(&quot;AREA&quot;, toupper(area), url, ignore.case=FALSE)
    read.csv(url, header = TRUE, sep = &quot;,&quot;, quote=&quot;\&quot;&quot;, dec=&quot;.&quot;, na.strings=&quot; &quot;, skip=0)
}</code></pre>
<p>CODEBOOK notes own_code - 3 = public ownership annual_avg_estabs =
Annual average of quarterly establishment counts for a given year
total_annual_wages = Sum of the four quarterly total wage levels for a
given year annual_contributions = Sum of the four quarterly contribution
totals for a given year annual_avg_wkly_wage = Avg weekly wage based on
12-monthly employment levels and annual wage levels. avg_annual_pay =
Average annual pay location quotient over the year change</p>
<pre class="r"><code>lac_naics &lt;- qcewGetAreaData(&quot;2023&quot;, &quot;a&quot;, &quot;06037&quot;) %&gt;% #all industries in LAC 
  clean_names()

lac_naics2 &lt;-  lac_naics %&gt;% # Industries of interest below in LA county
  rename(fips = area_fips, 
         naics = industry_code) %&gt;% 
  filter(naics %in% c(&quot;811192&quot;, &quot;315&quot;, 
                      &quot;493110&quot;, &quot;722513&quot;)) #filter to see if NAICS obsvr are in the vector</code></pre>
<pre class="r"><code>#sample NAICS 
lac_naics2 &lt;- lac_naics2[-c(2, 4:5, 7:8, 13, 16:26, 31:38)] </code></pre>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
